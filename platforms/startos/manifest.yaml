# Start9 StartOS Package Manifest
# https://docs.start9.com/

id: roostr
title: Roostr
version: 0.1.0
release-notes: Initial release
license: MIT
wrapper-repo: https://github.com/rdoiron/roostr
upstream-repo: https://github.com/rdoiron/roostr
support-site: https://github.com/rdoiron/roostr/issues
marketing-site: https://github.com/rdoiron/roostr
donation-url: https://getalby.com/p/ryand
build: []

description:
  short: Your Private Roost on Nostr
  long: |
    Roostr is a web-based admin interface for managing your private Nostr relay.
    It wraps nostr-rs-relay and provides dashboard, whitelist management,
    event browsing, sync from public relays, and paid relay access via Lightning.

assets:
  license: LICENSE
  icon: icon.png
  instructions: instructions.md

main:
  type: docker
  image: main
  entrypoint: /entrypoint.sh
  args: []
  mounts:
    main: /data

health-checks:
  api:
    name: API
    success-message: API is ready
    type: docker
    image: main
    entrypoint: /scripts/health-check.sh
    args: []
    inject: true
    io-format: yaml

config: ~

properties: ~

volumes:
  main:
    type: data

interfaces:
  main:
    name: Web Interface
    description: The main Roostr web interface
    tor-config:
      port-mapping:
        80: "8080"
    lan-config:
      443:
        ssl: true
        internal: 8080
    ui: true
    protocols:
      - tcp
      - http
  relay:
    name: Nostr Relay
    description: The Nostr relay WebSocket endpoint
    tor-config:
      port-mapping:
        7000: "7000"
    lan-config:
      7000:
        ssl: true
        internal: 7000
    ui: false
    protocols:
      - tcp
      - http
      - ws

dependencies: {}

backup:
  create:
    type: docker
    image: compat
    system: true
    entrypoint: compat
    args:
      - duplicity
      - create
      - /mnt/backup
      - /data
    mounts:
      BACKUP: /mnt/backup
      main: /data
  restore:
    type: docker
    image: compat
    system: true
    entrypoint: compat
    args:
      - duplicity
      - restore
      - /mnt/backup
      - /data
    mounts:
      BACKUP: /mnt/backup
      main: /data
